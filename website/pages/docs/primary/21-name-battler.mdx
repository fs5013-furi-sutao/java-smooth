---
title: ネームバトラー（初級編）
description: Rocket Docs changelog. Check the latest updates and see what's new.
disableTableOfContents: false
---

<strong style="color: #ff0000;">
  この課題は作成が完了したら、教育担当者にコードレビューを依頼してください
</strong>

## ネームバトラーとは？

ネームバトラーとは、「名前」からキャラクターを生成して、戦わせるゲームのことです。

入力した名前によって、キャラクターのパラメータ（体力、攻撃力、防御力など）が変わります。

類似のシステムで、バーコードを読み取ってキャラクターを生成して戦わせる
「バーコードバトラー」なんていうものもありました。

育成要素が追加されたゲームなどもあり、拡張次第では面白いゲームが作れます。

## 課題の内容

今回の課題は、ネームバトラーの基本形を作ってみることです。

以下の内容で順を追って作っていきます。
今までの課題とは違って、どんどん機能を追加して作りこんでいくタイプの課題です。

### 1. 基本のバトルシステムを作ろう

まずは基本の１対１のバトルシステムを作成します。
キャラクターが交互に攻撃して、相手を倒せば勝ち！

### 2. 名前でＨＰが変わるようにしてみよう

名前でキャラクターのステータスが変わらないと、ネームバトラーの意味がない！
というわけで、名前でＨＰが変化する仕組みを追加してみよう。

### 3. 名前で攻撃力が変わるようにしてみよう

ＨＰだけじゃつまらない。攻撃力も名前で変わるようにしてみよう。
ＨＰが低くても、攻撃力がめちゃめちゃ高いキャラクターが強い！？

### 4. 攻撃力と防御力でダメージ計算してみよう

防御力も名前で変わるようにしてみよう。
ダメージ計算にも、攻撃力と防御力を反映させるので、防御が高いと有利になる！？

### 5. 会心の一撃を追加してみよう

会心の一撃が出れば防御力を無視したダメージを与えられる！
防御力が高い相手でも、会心の一撃が出れば、一撃必殺！？
まずは基本のバトルシステムの作ってみよう。

## 1. 基本のバトルシステムを作ろう

まずは基本のバトルシステムの作ってみよう。

### ゲームの仕様

ゲームの仕様は以下のような感じです。

- キャラクター２人の自動バトルゲーム
- バトルの内容は、ＲＰＧ風に表示する
- 入力した名前で対戦ログが表示される
- 攻撃は交互に行う
- パラメータはＨＰのみで１０固定
- ダメージは１～３のランダムで計算する
- いずれかのＨＰが０以下になったらバトルは終了

### ゲームの流れ

以下の流れでゲームは進行します。

1. プレイヤー名の入力プレイヤー名の入力

- 1. 1. プレイヤー１の名前を決める
- 1. 2. プレイヤー２の名前を決める

2. キャラクターの作成キャラクターの作成

- 2. 1. プレイヤー１のキャラクターを作成
- 2. 2. プレイヤー２のキャラクターを作成

3. バトル開始の表示
4. プレイヤー１の攻撃ターン

- 4. 1. プレイヤー１の攻撃
- 4. 2. プレイヤー２のダメージ
- 4. 3. プレイヤー２の死亡判定 → ６へ

5. プレイヤー２の攻撃ターン

- 5. 1. プレイヤー２の攻撃
- 5. 2. プレイヤー１のダメージ
- 5. 3. プレイヤー１の死亡判定 → ６へ

※どちらかのＨＰが０になるまで、４と５の繰り返し

6. 勝ち負けの表示

### ゲームの実行例

```txt title=ゲームの実行例
プレイヤー 1 の名前を入力してください: 最強の戦士の血を引くもの
プレイヤー 2 の名前を入力してください: 伝説の勇者の友達

=== バトル開始 ===
最強の戦士の血を引くものの攻撃！
伝説の勇者の友達に 3 のダメージ！
伝説の勇者の友達の攻撃！
最強の戦士の血を引くものに 2 のダメージ！

- 次のターン -
プレイヤー 1: 最強の戦士の血を引くもの(HP 8)
プレイヤー 2: 伝説の勇者の友達(HP 7)

---

最強の戦士の血を引くものの攻撃！
伝説の勇者の友達に 3 のダメージ！
伝説の勇者の友達の攻撃！
最強の戦士の血を引くものに 2 のダメージ！

- 次のターン -
プレイヤー 1: 最強の戦士の血を引くもの(HP 6)
プレイヤー 2: 伝説の勇者の友達(HP 4)

---

最強の戦士の血を引くものの攻撃！
伝説の勇者の友達に 3 のダメージ！
伝説の勇者の友達の攻撃！
最強の戦士の血を引くものに 2 のダメージ！

- 次のターン -
プレイヤー 1: 最強の戦士の血を引くもの(HP 4)
プレイヤー２：伝説の勇者の友達(HP 1)

---

最強の戦士の血を引くものの攻撃！
伝説の勇者の友達に 2 のダメージ！
伝説の勇者の友達は力尽きた...
最強の戦士の血を引くものの勝利！！
```

## 2. 名前でＨＰが変わるようにしてみよう

名前でキャラクターのステータスが変わらないと、ネームバトラーの意味がない！
というわけで、名前でＨＰが変化する仕組みを追加してみよう。

### ゲームの追加仕様

これまでのゲームの仕様に、以下の仕様を追加します。

- ＨＰをキャラクターの名前から算出する

### 名前から数値を取得する方法

HP は数値ですが、名前は文字列です。

どうやって名前から数値を得るのか？が問題となりますが、ハッシュダイジェスト
（ハッシュ値）というもの便利なものがあります。

#### ハッシュ値とは

ハッシュ値というのは、以下の特徴があります。

- ハッシュ値は１６進数の４０文字の文字列である
- どんな長さの文字列であっても必ず４０文字の文字列になる
- 同じ文字列であれば必ず同じハッシュ値になる
- １文字違っただけでも全然違うハッシュ値になる

ハッシュ値は「０１２３４５６７８９ＡＢＣＤＥＦ」の文字で構成されているので、
16 進数の値として使うことができます。

16 進数って何？という人は、以下のサイトを見てください。

参考: 2 進数と 16 進数を覚えよう！
https://www.uquest.co.jp/embedded/learning/lecture01.html

実際に名前からハッシュ値を取得してみると、以下のようになります。

| 名前                     | 名前から取得したハッシュ値               |
| :----------------------- | :--------------------------------------- |
| 最強の戦士の血を引くもの | 2e8c925d7f95af418a8ba2504fb3457ba1d6eb6a |
| 伝説の勇者の友達         | 74c938ea2583ff510430ac0a98c3de5a0efd5751 |

| 基数    | 対応する値         |
| :------ | :----------------- |
| 16 進数 | 2e 8c 92 5d 7f…    |
| 10 進数 | 46 140 146 93 127… |

ハッシュ値を 2 文字毎に分けて、16 進数として考え、その値を 10 進数に変換する
ことで、0 ～ 255（00 ～ FF）の値を複数取り出すことができる。

ハッシュ値を表示するサンプルプログラムを紹介しておきます。
https://github.com/fs5013-furi-sutao/java-bootcamp-answers/blob/main/03.primary/19.name-battler/src/HashDigest.java

```java title=src/HashDigest.java
import java.math.BigInteger;
import java.security.MessageDigest;

public class HashDigest {
    public static void main(String[] args) {

        HashDigest app = new HashDigest();
        String[] names = {
            "最強の戦士の血を引くもの",
            "伝説の勇者の友達",
        };

        String[] digests = {
            app.getHashDigest(names[0]),
            app.getHashDigest(names[1]),
        };

        for (int i = 0; i < digests.length; i++) {
            System.out.printf(
                "「%s」のハッシュ値は「%s」",
                names[i], digests[i]
            );
        }
    }

    public String getHashDigest(String name) {
        try {
            // ハッシュ値を取得する
            byte[] result =
                MessageDigest.getInstance("SHA-1")
                .digest(name.getBytes());

            return String.format(
                "%040x",
                new BigInteger(1, result)
            );

        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }
}
```

### generateNumber() メソッドの紹介

名前からハッシュ値を取得して、16 進数の文字列を取得し、10 進数の数値に
変換して返すメソッドを紹介しておきます。

generateNumber メソッドと getHashDigest メソッド
https://github.com/fs5013-furi-sutao/java-bootcamp-answers/blob/main/03.primary/19.name-battler/src/HashDigest.java

名前から HP を決める処理は、こちらのメソッドを自分のプログラムに組み込んで使ってください。

なお、generateNumber()では、0 ～ 255 までの値が取得できるので、
HP が多すぎて戦闘が長引く可能性があります。

その場合は、5 で割った値をＨＰとして使用するなどすると良いでしょう。

```java
/**
 * ハッシュダイジェストから数値を取り出す
 * @param name 名前
 * @param index 何番目の数値を取り出すか
 * @return 数値(0 ～ 255)
 */
public int generateNumber(String name, int index) {
    try {
        String digest = getHashDigest(name);
        String hex = digest.substring(
            index * 2, index * 2 + 2
        );

        return Integer.parseInt(hex, 16);
    } catch (Exception e) {
        e.printStackTrace();
    }
    return 0;
}
public String getHashDigest(String name) {
    try {
        // ハッシュ値を取得する
        byte[] result =
            MessageDigest.getInstance("SHA-1")
            .digest(name.getBytes());
        return String.format(
            "%040x",
            new BigInteger(1, result)
        );
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
}
```

### generateNumber() の使い方

取得した数値を表示して確認してみて下さい。
名前を変えると取得できる数値が変わります。
何番目の数値を取り出すかで、取り出した数値が変わります。

```java
HashDigest app = new HashDigest();

String[] names = {
    "最強の戦士の血を引くもの",
    "伝説の勇者の友達",
};

System.out.println(app.generateNumber(names[0], 0));
System.out.println(app.generateNumber(names[0], 1));
System.out.println(app.generateNumber(names[0], 2));
```

```txt title=プログラムの実行結果
46
140
146
```

## 3. 名前で攻撃力が変わるようにしてみよう

名前からＨＰが決まるようになりましたが、ＨＰだけしかないのはつまらない！

ということで、次は攻撃力(STR)も名前で変わるようにしてみよう。
HP が低くても、攻撃力(STR)がめちゃめちゃ高いキャラクターが強いかも！？

### ゲームの追加仕様

これまでのゲームの仕様に、以下の仕様を追加します。

- 攻撃力(STR)をキャラクターの名前から算出する
- 攻撃時に相手に与えるダメージの計算式を以下の方法に変更する
  変更前：１～３の乱数
  変更後：１～攻撃力(STR)の値の乱数

## 4. 攻撃力と防御力でダメージ計算してみよう

続いて、防御力(DEF)も名前から取得するようにしてみよう。
HP と攻撃(STR)と防御力(DEF)のいずれも高い最強の名前を探し出せ！！

### ゲームの追加仕様

これまでのゲームの仕様に、以下の仕様を追加します。

- 防御力(DEF)をキャラクターの名前から算出する
- 攻撃時に相手に与えるダメージの計算式を以下の方法に変更する
  変更前：１～攻撃力(STR)の値の乱数
  変更後：攻撃側の攻撃力(STR) ー 防御側の防御力(DEF)

- ダメージが０以下の場合は、ダメージを０として扱う
- ダメージが０の場合は「攻撃がミス」と表示する

## 5. 会心の一撃を追加してみよう

会心の一撃、それは、防御力を無視したダメージ！
つまり…
防御力がめちゃくちゃ高い相手でも、会心の一撃が出れば一撃必殺！？
そんな会心の一撃を追加してみよう。

### ゲームの追加仕様

これまでのゲームの仕様に、以下の仕様を追加します。

- 運(LUCK)をキャラクターの名前から算出する
- 運(LUCK)が高いほど、会心の一撃の確率が高くなるようにする
  ※実装方法は自由です。バランスを調整して実装してみよう
- 会心の一撃が出た場合は、攻撃力(STR)の値をそのままダメージの値として使う
