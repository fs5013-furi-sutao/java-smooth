---
title: 25. 🐽 「不吉なにおい」とは
section: 02.入門編
slug: /entry/25-code-smell
order: 25
---

# 25. 🐽 「不吉なにおい」とは

<p class="goal">
  コーディングにおける「不吉なにおい」というのが分かること。
  「不吉なにおい」というのを念頭に置いてコーディングできるようになること
</p>

ここの学習では **「不吉なにおいとは何か」 ** というのを押さえておいてください。今回、ミニ課題はありません。

以下では、不吉なにおいの種類などをまとめていますが、** まだ理解できないことばかりだと思います。** この先、学習を進めていった際に、改めて見ると新たな気づきが出てくるはずです。不吉なにおいやリファクタリングについては、この分野にアンテナを張りつつ、この先少しずつ理解していきましょう。

以下の一覧にあるような観点で自分のコードを自己レビューする習慣を付ければ、どんどん ** 品質の高いコーディング ** ができるようになります。

## 学習

### 「不吉なにおい」とは何かを知る

「不吉なにおい」とは何かを Web で調べてください。検索キーワードは、「 [java 不吉なにおい](https://www.google.com/search?q=java+不吉なにおい) 」です。

### 不吉なにおい一覧

ここでは Martin Fawler の書籍「リファクタリング」で紹介されている 22 個の「コードの不吉なにおい」についてのリストをまとめておきます。

<table>
  <thead>
    <tr>
      <th scope="col">No.</th>
      <th scope="col">不吉なにおい</th>
      <th scope="col">詳細</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>重複したコード</td>
      <td>コードがあちこちでダブっている</td>
    </tr>
    <tr>
      <td>2</td>
      <td>長すぎるメソッド</td>
      <td>メソッドが長過ぎる</td>
    </tr>
    <tr>
      <td>3</td>
      <td>巨大なクラス（ゴッドクラス）</td>
      <td>クラスが持っているフィールドやメソッドが多過ぎる</td>
    </tr>
    <tr>
      <td>4</td>
      <td>長すぎるパラメータリスト</td>
      <td>メソッドへ渡す引数の数が多過ぎる</td>
    </tr>
    <tr>
      <td>5</td>
      <td>変更の偏り</td>
      <td>仕様変更が起きた時の修正箇所があちこちに散らばっている</td>
    </tr>
    <tr>
      <td>6</td>
      <td>変更の分散</td>
      <td>
        あるクラスを修正すると、他のクラスもあわせて修正しなければならない
      </td>
    </tr>
    <tr>
      <td>7</td>
      <td>特性の横恋慕</td>
      <td>いつも他のクラスの中身をいじっているクラスがある</td>
    </tr>
    <tr>
      <td>8</td>
      <td>データの群れ</td>
      <td>まとめて扱うべき複数のデータが、1つのクラスにまとまっていない</td>
    </tr>
    <tr>
      <td>9</td>
      <td>基本データ型への執着</td>
      <td>クラスをつくらず、int のような基本データ型ばかり使っている</td>
    </tr>
    <tr>
      <td>10</td>
      <td>スイッチ文</td>
      <td>switch 文や if 文を使って振る舞いを分けている</td>
    </tr>
    <tr>
      <td>11</td>
      <td>パラレル継承</td>
      <td>
        サブクラスを作ると、クラス階層の別のところにもサブクラスを作らなければならない
      </td>
    </tr>
    <tr>
      <td>12</td>
      <td>怠け者クラス</td>
      <td>クラスがたいした仕事をしていない</td>
    </tr>
    <tr>
      <td>13</td>
      <td>疑わしき一般化</td>
      <td>いつかこういう拡張もするだろうと期待して、一般化しすぎる</td>
    </tr>
    <tr>
      <td>14</td>
      <td>一時的属性</td>
      <td>一時的にしか使わないフィールドがある</td>
    </tr>
    <tr>
      <td>15</td>
      <td>メッセージの連鎖</td>
      <td>メソッド呼び出しの連鎖が多過ぎる</td>
    </tr>
    <tr>
      <td>16</td>
      <td>仲介人</td>
      <td>委譲ばかりしていて、自分では仕事をしていないクラスがある</td>
    </tr>
    <tr>
      <td>17</td>
      <td>不適切な関係</td>
      <td>
        その必要がないのに双方向リンクを張っていたり、IS - A
        関係がないのに継承を使っていたりする
      </td>
    </tr>
    <tr>
      <td>18</td>
      <td>クラスのインタフェース不一致</td>
      <td>クラスのインタフェース（API）が不適切である</td>
    </tr>
    <tr>
      <td>19</td>
      <td>未熟なクラスライブラリ</td>
      <td>既存のクラスライブラリが使いにくい</td>
    </tr>
    <tr>
      <td>20</td>
      <td>データクラス</td>
      <td>
        フィールドと getter メソッドと setter
        メソッドしか持っていないクラスがある
      </td>
    </tr>
    <tr>
      <td>21</td>
      <td>相続拒否</td>
      <td>継承しているメソッドなのに、それを呼ぶと問題が起きる</td>
    </tr>
    <tr>
      <td>22</td>
      <td>コメント</td>
      <td>コードの不備を補うために、詳しいコメントがある</td>
    </tr>
  </tbody>
</table>

### リファクタリング対応例一覧

さらに、各「不吉なにおい」に対する、リファクタリング対応をまとめておきます。これらの内容は、現段階ではまだ分からないと思いますが、学習を進めていく中で少しずつ理解できるようにしていきましょう。

<table>
  <thead>
    <tr>
      <th scope="col">No.</th>
      <th scope="col">不吉なにおい</th>
      <th scope="col">リファクタリング対応例</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>重複したコード</td>
      <td>
        Template Method の形成
        <br />
        クラスの抽出
        <br />
        メソッドの抽出
        <br />
        メソッドの引き上げ
      </td>
    </tr>
    <tr>
      <td>2</td>
      <td>長すぎるメソッド</td>
      <td>
        条件記述の分解
        <br />
        問い合わせによる一時変数の置き換え
        <br />
        メソッドオブジェクトによるメソッドの置き換え
        <br />
        メソッドの抽出
      </td>
    </tr>
    <tr>
      <td>3</td>
      <td>巨大なクラス（ゴッドクラス）</td>
      <td>
        インタフェースの抽出
        <br />
        オブジェクトによるデータ値の置き換え
        <br />
        クラスの抽出
        <br />
        サブクラスの抽出
      </td>
    </tr>
    <tr>
      <td>4</td>
      <td>長すぎるパラメータリスト</td>
      <td>
        オブジェクトそのものの受け渡し
        <br />
        パラメータオブジェクトの導入
        <br />
        メソッドによるパラメータの置き換え
      </td>
    </tr>
    <tr>
      <td>5</td>
      <td>変更の偏り</td>
      <td>クラスの抽出</td>
    </tr>
    <tr>
      <td>6</td>
      <td>変更の分散</td>
      <td>
        クラスのインライン化
        <br />
        フィールドの導入
        <br />
        メソッドの導入
      </td>
    </tr>
    <tr>
      <td>7</td>
      <td>特性の横恋慕</td>
      <td>
        フィールドの移動
        <br />
        メソッドの移動
        <br />
        メソッドの抽出
      </td>
    </tr>
    <tr>
      <td>8</td>
      <td>データの群れ</td>
      <td>
        オブジェクトそのものの受け渡し
        <br />
        クラスの抽出
        <br />
        引数オブジェクトの導入
      </td>
    </tr>
    <tr>
      <td>9</td>
      <td>基本データ型への執着</td>
      <td>
        State/Strategy によるタイプコードの置き換え
        <br />
        オブジェクトによるデータ値の置き換え
        <br />
        オブジェクトによる配列の置き換え
        <br />
        クラスによるタイプコードの置き換え
        <br />
        クラスの抽出
        <br />
        サブクラスによるタイプコードの置き換え
        <br />
        パラメータオブジェクトの導入
      </td>
    </tr>
    <tr>
      <td>10</td>
      <td>スイッチ文</td>
      <td>
        State/Strategy によるタイプコードの置き換え
        <br />
        サブクラスによるタイプコードの置き換え
        <br />
        ヌルオブジェクトの導入
        <br />
        ポリモーフィズムによる条件記述の置き換え
        <br />
        明示的なメソッド群によるパラメータの置き換え
      </td>
    </tr>
    <tr>
      <td>11</td>
      <td>パラレル継承</td>
      <td>
        フィールドの移動
        <br />
        メソッドの移動
      </td>
    </tr>
    <tr>
      <td>12</td>
      <td>怠け者クラス</td>
      <td>
        階層の平坦化
        <br />
        クラスのインライン化
      </td>
    </tr>
    <tr>
      <td>13</td>
      <td>疑わしき一般化</td>
      <td>
        階層の平坦化
        <br />
        クラスのインライン化
        <br />
        パラメータの削除
        <br />
        メソッド名の変更
      </td>
    </tr>
    <tr>
      <td>14</td>
      <td>一時的属性</td>
      <td>
        クラスの抽出
        <br />
        ヌルオブジェクトの導入
      </td>
    </tr>
    <tr>
      <td>15</td>
      <td>メッセージの連鎖</td>
      <td>委譲の隠蔽</td>
    </tr>
    <tr>
      <td>16</td>
      <td>仲介人</td>
      <td>
        継承による委譲の置き換え
        <br />
        仲介人の除去
        <br />
        メソッドのインライン化
      </td>
    </tr>
    <tr>
      <td>17</td>
      <td>不適切な関係</td>
      <td>
        委譲による継承の置き換え
        <br />
        委譲の隠蔽
        <br />
        双方向関連の単方向への変更
        <br />
        フィールドの移動
        <br />
        メソッドの移動
      </td>
    </tr>
    <tr>
      <td>18</td>
      <td>クラスのインタフェース不一致</td>
      <td>
        メソッドの移動
        <br />
        メソッド名の変更
      </td>
    </tr>
    <tr>
      <td>19</td>
      <td>未熟なクラスライブラリ</td>
      <td>
        外部メソッドの導入
        <br />
        局所的拡張の導入
      </td>
    </tr>
    <tr>
      <td>20</td>
      <td>データクラス</td>
      <td>
        コレクションのカプセル化
        <br />
        フィールドのカプセル化
        <br />
        メソッドの移動
      </td>
    </tr>
    <tr>
      <td>21</td>
      <td>相続拒否</td>
      <td>委譲による継承の置き換え</td>
    </tr>
    <tr>
      <td>22</td>
      <td>コメント</td>
      <td>
        表明（Assertion）の導入
        <br />
        メソッドの抽出
      </td>
    </tr>
  </tbody>
</table>
